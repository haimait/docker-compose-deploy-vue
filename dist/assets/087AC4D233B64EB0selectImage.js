/*! 
 Build based on gin-vue-admin 
 Time : 1707920194000 */
import{_ as e,a,T as l,P as t,o as s,c as o,H as i,G as u,h as r,w as d,d as m,e as n,b as p,cu as c,g as v,cP as g,N as y,O as f,cR as C,t as k,Q as B,k as b,J as E,l as V,E as _}from"./087AC4D233B64EB0index.js";import{E as j}from"./087AC4D233B64EB0drawer.js";import"./087AC4D233B64EB0overlay.js";import{E as A}from"./087AC4D233B64EB0pagination.js";/* empty css                     */import"./087AC4D233B64EB0tag.js";import"./087AC4D233B64EB0select.js";import"./087AC4D233B64EB0scrollbar.js";/* empty css                      */import{E as h}from"./087AC4D233B64EB0image-viewer.js";import{a as x,E as D}from"./087AC4D233B64EB0form-item.js";/* empty css                      *//* empty css                     */import{g as w,b as U}from"./087AC4D233B64EB0image.js";import{_ as z,U as S,e as T,g as P}from"./087AC4D233B64EB0common.js";import{_ as O}from"./087AC4D233B64EB0warningBar.js";const I=["src"],N={key:1,class:"multiple-img"},F=["onClick"],G=["src"],H=["onClick"],J={key:0,class:"add-image"},M={class:"gva-btn-list"},Q={class:"media"},R={class:"header-img-box-list"},q=["onClick"],K=["src"],L={key:2,class:"header-img-box-list"},W=["onClick"],X=e({__name:"selectImage",props:{modelValue:{type:[String,Array],default:""},multiple:{type:Boolean,default:!1},fileType:{type:String,default:""},maxUpdateCount:{type:Number,default:0}},emits:["update:modelValue"],setup(e,{emit:X}){const Y=a(""),Z=a(""),$=a({}),ee=a(1),ae=a(0),le=a(20),te=e,se=a([]);l((()=>{te.multiple&&(se.value=te.modelValue)}));const oe=X,ie=e=>{se.value.splice(e,1),oe("update:modelValue",se.value)},ue=e=>{le.value=e,ve()},re=e=>{ee.value=e,ve()},de=a(!1),me=a([]),ne={image:["png","jpg","jpeg","gif","bmp","webp"],video:["mp4","avi","rmvb","rm","asf","divx","mpg","mpeg","mpe","wmv","mkv","vob"]},pe=e=>{if(console.log(e),te.fileType){if(!ne[te.fileType].some((a=>{if(e.includes(a))return!0})))return void b({type:"error",message:"当前类型不支持使用"})}te.multiple?(se.value.push(e),oe("update:modelValue",se.value)):oe("update:modelValue",e),de.value=!1},ce=async()=>{!te.modelValue||te.multiple?(await ve(),de.value=!0):oe("update:modelValue","")},ve=async()=>{const e=await P({page:ee.value,pageSize:le.value,...$.value});0===e.code&&(me.value=e.data.list,ae.value=e.data.total,ee.value=e.data.page,le.value=e.data.pageSize)};return(a,l)=>{const P=t("VideoPlay"),X=E,te=V,oe=x,ne=_,ge=D,ye=h,fe=A,Ce=j;return s(),o(y,null,[e.multiple?(s(),o("div",N,[(s(!0),o(y,null,f(se.value,((e,a)=>(s(),o("div",{key:a,class:"update-image",style:i({"background-image":"url(".concat(u(w)(e),")"),position:"relative"})},[u(U)(e||"")?(s(),r(X,{key:0,size:32,class:"video video-icon"},{default:d((()=>[m(P)])),_:1})):n("",!0),u(U)(e||"")?(s(),o("video",{key:1,class:"avatar video-avatar video",muted:"",preload:"metadata",onClick:e=>ie(a)},[p("source",{src:u(w)(e)+"#t=1"},null,8,G)],8,F)):n("",!0),p("span",{class:"update",style:{position:"absolute"},onClick:e=>ie(a)},[m(X,null,{default:d((()=>[m(u(c))])),_:1}),v(" 删除")],8,H)],4)))),128)),!e.maxUpdateCount||e.maxUpdateCount>se.value.length?(s(),o("div",J,[p("span",{class:"update text-gray-600",onClick:ce},[m(X,null,{default:d((()=>[m(u(g))])),_:1}),v(" 上传")])])):n("",!0)])):(s(),o("div",{key:0,class:"update-image",style:i({"background-image":"url(".concat(u(w)(e.modelValue),")"),position:"relative"})},[u(U)(e.modelValue||"")?(s(),r(X,{key:0,size:32,class:"video video-icon",style:{}},{default:d((()=>[m(P)])),_:1})):n("",!0),u(U)(e.modelValue||"")?(s(),o("video",{key:1,class:"avatar video-avatar video",muted:"",preload:"metadata",style:{},onClick:ce},[p("source",{src:u(w)(e.modelValue)+"#t=1"},null,8,I)])):n("",!0),e.modelValue?(s(),o("span",{key:2,class:"update",style:{position:"absolute"},onClick:ce},[m(X,null,{default:d((()=>[m(u(c))])),_:1}),v(" 删除")])):(s(),o("span",{key:3,class:"update text-gray-600",onClick:ce},[m(X,null,{default:d((()=>[m(u(g))])),_:1}),v(" 上传")]))],4)),m(Ce,{modelValue:de.value,"onUpdate:modelValue":l[3]||(l[3]=e=>de.value=e),title:"媒体库",size:"650px"},{default:d((()=>[m(O,{title:"点击“文件名/备注”可以编辑文件名或者备注内容。"}),p("div",M,[m(z,{imageCommon:Z.value,"onUpdate:imageCommon":l[0]||(l[0]=e=>Z.value=e),class:"upload-btn-media-library",onOnSuccess:ve},null,8,["imageCommon"]),m(S,{imageUrl:Y.value,"onUpdate:imageUrl":l[1]||(l[1]=e=>Y.value=e),"file-size":512,"max-w-h":1080,class:"upload-btn-media-library",onOnSuccess:ve},null,8,["imageUrl"]),m(ge,{ref:"searchForm",inline:!0,model:$.value},{default:d((()=>[m(oe,{label:""},{default:d((()=>[m(te,{modelValue:$.value.keyword,"onUpdate:modelValue":l[2]||(l[2]=e=>$.value.keyword=e),class:"keyword",placeholder:"请输入文件名或备注"},null,8,["modelValue"])])),_:1}),m(oe,null,{default:d((()=>[m(ne,{type:"primary",icon:"search",onClick:ve},{default:d((()=>[v("查询 ")])),_:1})])),_:1})])),_:1},8,["model"])]),p("div",Q,[(s(!0),o(y,null,f(me.value,((e,a)=>(s(),o("div",{key:a,class:"media-box"},[p("div",R,[(s(),r(ye,{key:a,src:u(w)(e.url),fit:"cover",style:{width:"100%",height:"100%"},onClick:a=>pe(e.url)},{error:d((()=>[u(U)(e.url||"")?(s(),r(X,{key:0,size:32,class:"video video-icon"},{default:d((()=>[m(P)])),_:1})):n("",!0),u(U)(e.url||"")?(s(),o("video",{key:1,class:"avatar video-avatar video",muted:"",preload:"metadata",onClick:a=>pe(e.url)},[p("source",{src:u(w)(e.url)+"#t=1"},null,8,K),v(" 您的浏览器不支持视频播放 ")],8,q)):(s(),o("div",L,[m(X,{class:"lost-image"},{default:d((()=>[m(u(C))])),_:1})]))])),_:2},1032,["src","onClick"]))]),p("div",{class:"img-title",onClick:a=>(async e=>{B.prompt("请输入文件名或者备注","编辑",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"不能为空",inputValue:e.name}).then((async({value:a})=>{e.name=a,0===(await T(e)).code&&(b({type:"success",message:"编辑成功!"}),ve())})).catch((()=>{b({type:"info",message:"取消修改"})}))})(e)},k(e.name),9,W)])))),128))]),m(fe,{"current-page":ee.value,"page-size":le.value,total:ae.value,style:{"justify-content":"center"},layout:"total, prev, pager, next, jumper",onCurrentChange:re,onSizeChange:ue},null,8,["current-page","page-size","total"])])),_:1},8,["modelValue"])],64)}}},[["__scopeId","data-v-f18aaeb3"]]);export{X as S};
