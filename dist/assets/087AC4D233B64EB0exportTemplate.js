/*! 
 Build based on gin-vue-admin 
 Time : 1707920194000 */
import{v as e,a,r as l,P as t,o as r,c as o,d as u,b as s,w as d,g as i,q as p,t as n,G as m,Q as c,k as v,J as f,l as g,E as b}from"./087AC4D233B64EB0index.js";import{E as B,a as C}from"./087AC4D233B64EB0descriptions-item.js";import{E as y}from"./087AC4D233B64EB0dialog.js";import"./087AC4D233B64EB0overlay.js";import{E}from"./087AC4D233B64EB0scrollbar.js";import{E as h}from"./087AC4D233B64EB0pagination.js";/* empty css                     */import"./087AC4D233B64EB0tag.js";import"./087AC4D233B64EB0select.js";/* empty css                      */import{E as A,a as D}from"./087AC4D233B64EB0table-column.js";import"./087AC4D233B64EB0checkbox.js";/* empty css                       */import{E as _}from"./087AC4D233B64EB0popover.js";import{a as j,E as x}from"./087AC4D233B64EB0form-item.js";/* empty css                      */import{E as w}from"./087AC4D233B64EB0date-picker.js";/* empty css                     */import{f as I}from"./087AC4D233B64EB0format.js";import{_ as V}from"./087AC4D233B64EB0warningBar.js";import{E as k}from"./087AC4D233B64EB0index20.js";import"./087AC4D233B64EB0isUndefined.js";import"./087AC4D233B64EB0isEqual.js";import"./087AC4D233B64EB0_Uint8Array.js";import"./087AC4D233B64EB0hasIn.js";import"./087AC4D233B64EB0index21.js";import"./087AC4D233B64EB0strings.js";import"./087AC4D233B64EB0debounce.js";import"./087AC4D233B64EB0_initCloneObject.js";import"./087AC4D233B64EB0dropdown.js";import"./087AC4D233B64EB0castArray.js";import"./087AC4D233B64EB0_baseClone.js";import"./087AC4D233B64EB0arrays.js";import"./087AC4D233B64EB0index22.js";import"./087AC4D233B64EB0date.js";import"./087AC4D233B64EB0dictionary.js";import"./087AC4D233B64EB0sysDictionary2.js";const T=a=>e({url:"/sysExportTemplate/createSysExportTemplate",method:"post",data:a}),U=a=>e({url:"/sysExportTemplate/findSysExportTemplate",method:"get",params:a}),N={class:"gva-search-box"},S={class:"gva-table-box"},z={class:"gva-btn-list"},q=s("p",null,"确定要删除吗？",-1),F={style:{"text-align":"right","margin-top":"8px"}},O={class:"gva-pagination"},G={class:"dialog-footer"},J=Object.assign({name:"ExportTemplate"},{__name:"exportTemplate",setup(J){const K=a({name:"",tableName:"",templateID:"",templateInfo:""}),Q=l({name:[{required:!0,message:"",trigger:["input","blur"]},{whitespace:!0,message:"不能只输入空格",trigger:["input","blur"]}],tableName:[{required:!0,message:"",trigger:["input","blur"]},{whitespace:!0,message:"不能只输入空格",trigger:["input","blur"]}],templateID:[{required:!0,message:"",trigger:["input","blur"]},{whitespace:!0,message:"不能只输入空格",trigger:["input","blur"]}],templateInfo:[{required:!0,message:"",trigger:["input","blur"]},{whitespace:!0,message:"不能只输入空格",trigger:["input","blur"]}]}),R=l({createdAt:[{validator:(e,a,l)=>{X.value.startCreatedAt&&!X.value.endCreatedAt?l(new Error("请填写结束日期")):!X.value.startCreatedAt&&X.value.endCreatedAt?l(new Error("请填写开始日期")):X.value.startCreatedAt&&X.value.endCreatedAt&&(X.value.startCreatedAt.getTime()===X.value.endCreatedAt.getTime()||X.value.startCreatedAt.getTime()>X.value.endCreatedAt.getTime())?l(new Error("开始日期应当早于结束日期")):l()},trigger:"change"}]}),L=a(),P=a(),Z=a(1),H=a(0),M=a(10),W=a([]),X=a({}),Y=()=>{X.value={},le()},$=()=>{var e;null==(e=P.value)||e.validate((async e=>{e&&(Z.value=1,M.value=10,le())}))},ee=e=>{M.value=e,le()},ae=e=>{Z.value=e,le()},le=async()=>{const a=await(l={page:Z.value,pageSize:M.value,...X.value},e({url:"/sysExportTemplate/getSysExportTemplateList",method:"get",params:l}));var l;0===a.code&&(W.value=a.data.list,H.value=a.data.total,Z.value=a.data.page,M.value=a.data.pageSize)};le();(async()=>{})();const te=a([]),re=e=>{te.value=e},oe=a(!1),ue=async()=>{const a=[];if(0===te.value.length)return void v({type:"warning",message:"请选择要删除的数据"});te.value&&te.value.map((e=>{a.push(e.ID)}));var l;0===(await(l={ids:a},e({url:"/sysExportTemplate/deleteSysExportTemplateByIds",method:"delete",data:l}))).code&&(v({type:"success",message:"删除成功"}),W.value.length===a.length&&Z.value>1&&Z.value--,oe.value=!1,le())},se=a(""),de=async a=>{var l;0===(await(l={ID:a.ID},e({url:"/sysExportTemplate/deleteSysExportTemplate",method:"delete",data:l}))).code&&(v({type:"success",message:"删除成功"}),1===W.value.length&&Z.value>1&&Z.value--,le())},ie=a(!1),pe=a(!1),ne=async e=>{const a=await U({ID:e.ID});0===a.code&&(K.value=a.data.resysExportTemplate,pe.value=!0)},me=()=>{pe.value=!1,K.value={name:"",tableName:"",templateID:"",templateInfo:""}},ce=()=>{se.value="create",ie.value=!0},ve=()=>{ie.value=!1,K.value={name:"",tableName:"",templateID:"",templateInfo:""}},fe=async()=>{var a;try{JSON.parse(K.value.templateInfo)}catch(l){return void v({type:"error",message:"模板信息格式不正确，请检查"})}null==(a=L.value)||a.validate((async a=>{if(!a)return;let l;switch(se.value){case"create":default:l=await T(K.value);break;case"update":l=await(t=K.value,e({url:"/sysExportTemplate/updateSysExportTemplate",method:"put",data:t}))}var t;0===l.code&&(v({type:"success",message:"创建/更改成功"}),ve(),le())}))};return(e,a)=>{const l=t("QuestionFilled"),v=f,T=k,J=w,le=j,ge=g,be=b,Be=x,Ce=_,ye=A,Ee=t("InfoFilled"),he=D,Ae=h,De=E,_e=y,je=B,xe=C;return r(),o("div",null,[u(V,{title:"本功能提供同步的表格导出功能，大数据量的异步表格导出功能，可以选择点我定制",href:"https://flipped-aurora.feishu.cn/docx/KwjxdnvatozgwIxGV0rcpkZSn4d"}),s("div",N,[u(Be,{ref_key:"elSearchFormRef",ref:P,inline:!0,model:X.value,class:"demo-form-inline",rules:R,onKeyup:p($,["enter"])},{default:d((()=>[u(le,{label:"创建日期",prop:"createdAt"},{label:d((()=>[s("span",null,[i(" 创建日期 "),u(T,{content:"搜索范围是开始日期（包含）至结束日期（不包含）"},{default:d((()=>[u(v,null,{default:d((()=>[u(l)])),_:1})])),_:1})])])),default:d((()=>[u(J,{modelValue:X.value.startCreatedAt,"onUpdate:modelValue":a[0]||(a[0]=e=>X.value.startCreatedAt=e),type:"datetime",placeholder:"开始日期","disabled-date":e=>!!X.value.endCreatedAt&&e.getTime()>X.value.endCreatedAt.getTime()},null,8,["modelValue","disabled-date"]),i(" — "),u(J,{modelValue:X.value.endCreatedAt,"onUpdate:modelValue":a[1]||(a[1]=e=>X.value.endCreatedAt=e),type:"datetime",placeholder:"结束日期","disabled-date":e=>!!X.value.startCreatedAt&&e.getTime()<X.value.startCreatedAt.getTime()},null,8,["modelValue","disabled-date"])])),_:1}),u(le,{label:"模板名称",prop:"name"},{default:d((()=>[u(ge,{modelValue:X.value.name,"onUpdate:modelValue":a[2]||(a[2]=e=>X.value.name=e),placeholder:"搜索条件"},null,8,["modelValue"])])),_:1}),u(le,{label:"表名称",prop:"tableName"},{default:d((()=>[u(ge,{modelValue:X.value.tableName,"onUpdate:modelValue":a[3]||(a[3]=e=>X.value.tableName=e),placeholder:"搜索条件"},null,8,["modelValue"])])),_:1}),u(le,{label:"模板标识",prop:"templateID"},{default:d((()=>[u(ge,{modelValue:X.value.templateID,"onUpdate:modelValue":a[4]||(a[4]=e=>X.value.templateID=e),placeholder:"搜索条件"},null,8,["modelValue"])])),_:1}),u(le,null,{default:d((()=>[u(be,{type:"primary",icon:"search",onClick:$},{default:d((()=>[i("查询")])),_:1}),u(be,{icon:"refresh",onClick:Y},{default:d((()=>[i("重置")])),_:1})])),_:1})])),_:1},8,["model","rules"])]),s("div",S,[s("div",z,[u(be,{type:"primary",icon:"plus",onClick:ce},{default:d((()=>[i("新增")])),_:1}),u(Ce,{visible:oe.value,"onUpdate:visible":a[7]||(a[7]=e=>oe.value=e),disabled:!te.value.length,placement:"top",width:"160"},{reference:d((()=>[u(be,{icon:"delete",style:{"margin-left":"10px"},disabled:!te.value.length,onClick:a[6]||(a[6]=e=>oe.value=!0)},{default:d((()=>[i("删除")])),_:1},8,["disabled"])])),default:d((()=>[q,s("div",F,[u(be,{type:"primary",link:"",onClick:a[5]||(a[5]=e=>oe.value=!1)},{default:d((()=>[i("取消")])),_:1}),u(be,{type:"primary",onClick:ue},{default:d((()=>[i("确定")])),_:1})])])),_:1},8,["visible","disabled"])]),u(he,{ref:"multipleTable",style:{width:"100%"},"tooltip-effect":"dark",data:W.value,"row-key":"ID",onSelectionChange:re},{default:d((()=>[u(ye,{type:"selection",width:"55"}),u(ye,{align:"left",label:"日期",width:"180"},{default:d((e=>[i(n(m(I)(e.row.CreatedAt)),1)])),_:1}),u(ye,{align:"left",label:"模板名称",prop:"name",width:"120"}),u(ye,{align:"left",label:"表名称",prop:"tableName",width:"120"}),u(ye,{align:"left",label:"模板标识",prop:"templateID",width:"120"}),u(ye,{align:"left",label:"模板信息",prop:"templateInfo","min-width":"120"}),u(ye,{align:"left",label:"操作","min-width":"120"},{default:d((e=>[u(be,{type:"primary",link:"",class:"table-button",onClick:a=>ne(e.row)},{default:d((()=>[u(v,{style:{"margin-right":"5px"}},{default:d((()=>[u(Ee)])),_:1}),i(" 查看详情 ")])),_:2},1032,["onClick"]),u(be,{type:"primary",link:"",icon:"edit",class:"table-button",onClick:a=>(async e=>{const a=await U({ID:e.ID});se.value="update",0===a.code&&(K.value=a.data.resysExportTemplate,ie.value=!0)})(e.row)},{default:d((()=>[i("变更")])),_:2},1032,["onClick"]),u(be,{type:"primary",link:"",icon:"delete",onClick:a=>{return l=e.row,void c.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{de(l)}));var l}},{default:d((()=>[i("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),s("div",O,[u(Ae,{layout:"total, sizes, prev, pager, next, jumper","current-page":Z.value,"page-size":M.value,"page-sizes":[10,30,50,100],total:H.value,onCurrentChange:ae,onSizeChange:ee},null,8,["current-page","page-size","total"])])]),u(_e,{modelValue:ie.value,"onUpdate:modelValue":a[12]||(a[12]=e=>ie.value=e),"before-close":ve,title:"create"===se.value?"添加":"修改","destroy-on-close":""},{footer:d((()=>[s("div",G,[u(be,{onClick:ve},{default:d((()=>[i("取 消")])),_:1}),u(be,{type:"primary",onClick:fe},{default:d((()=>[i("确 定")])),_:1})])])),default:d((()=>[u(De,{height:"500px"},{default:d((()=>[u(Be,{ref_key:"elFormRef",ref:L,model:K.value,"label-position":"right",rules:Q,"label-width":"100px"},{default:d((()=>[u(le,{label:"模板名称:",prop:"name"},{default:d((()=>[u(ge,{modelValue:K.value.name,"onUpdate:modelValue":a[8]||(a[8]=e=>K.value.name=e),clearable:!0,placeholder:"请输入模板名称"},null,8,["modelValue"])])),_:1}),u(le,{label:"表名称:",prop:"tableName"},{default:d((()=>[u(ge,{modelValue:K.value.tableName,"onUpdate:modelValue":a[9]||(a[9]=e=>K.value.tableName=e),clearable:!0,placeholder:"请输入要导出的表名称"},null,8,["modelValue"])])),_:1}),u(le,{label:"模板标识:",prop:"templateID"},{default:d((()=>[u(ge,{modelValue:K.value.templateID,"onUpdate:modelValue":a[10]||(a[10]=e=>K.value.templateID=e),clearable:!0,placeholder:"模板标识为前端组件需要挂在的标识属性"},null,8,["modelValue"])])),_:1}),u(le,{label:"模板信息:",prop:"templateInfo"},{default:d((()=>[u(ge,{modelValue:K.value.templateInfo,"onUpdate:modelValue":a[11]||(a[11]=e=>K.value.templateInfo=e),type:"textarea",rows:16,clearable:!0,placeholder:'模板信息格式：key标识数据库column列名称，value标识导出excel列名称，如下：\n{\n  "table_name1":"第一列",\n  "table_name2":"第二列",\n  "table_name3":"第三列",\n  "table_name4":"第四列",\n}'},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1},8,["modelValue","title"]),u(_e,{modelValue:pe.value,"onUpdate:modelValue":a[13]||(a[13]=e=>pe.value=e),style:{width:"800px"},"lock-scroll":"","before-close":me,title:"查看详情","destroy-on-close":""},{default:d((()=>[u(De,{height:"550px"},{default:d((()=>[u(xe,{column:"1",border:""},{default:d((()=>[u(je,{label:"模板名称"},{default:d((()=>[i(n(K.value.name),1)])),_:1}),u(je,{label:"表名称"},{default:d((()=>[i(n(K.value.tableName),1)])),_:1}),u(je,{label:"模板标识"},{default:d((()=>[i(n(K.value.templateID),1)])),_:1}),u(je,{label:"模板信息"},{default:d((()=>[i(n(K.value.templateInfo),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])}}});export{J as default};
