/*! 
 Build based on gin-vue-admin 
 Time : 1707920194000 */
import{a as e,o as a,h as l,w as t,d as s,b as o,g as r,c as i,N as n,O as u,G as m,t as p,Q as c,k as d,l as g,E as v,J as B}from"./087AC4D233B64EB0index.js";import{E as C}from"./087AC4D233B64EB0drawer.js";import"./087AC4D233B64EB0overlay.js";import{E as f}from"./087AC4D233B64EB0pagination.js";/* empty css                     */import"./087AC4D233B64EB0tag.js";import"./087AC4D233B64EB0select.js";import"./087AC4D233B64EB0scrollbar.js";/* empty css                      */import{E as y}from"./087AC4D233B64EB0image-viewer.js";/* empty css                     */import{a as E,E as j}from"./087AC4D233B64EB0form-item.js";/* empty css                      */import{g as A}from"./087AC4D233B64EB0image.js";import{_ as D,U as b,g as x,e as _}from"./087AC4D233B64EB0common.js";import{_ as h}from"./087AC4D233B64EB0warningBar.js";const k={class:"gva-btn-list"},w={class:"media"},U={class:"header-img-box-list"},z={class:"header-img-box-list"},S=o("picture",null,null,-1),V=["onClick"],O={__name:"index",props:{target:{type:Object,default:null},targetKey:{type:String,default:""}},emits:["enterImg"],setup(O,{expose:I,emit:K}){const T=e(""),F=e(""),G=e({}),J=e(1),M=e(0),N=e(20),P=e=>{N.value=e,R()},Q=e=>{J.value=e,R()},q=K,H=e(!1),L=e([]),R=async()=>{const e=await x({page:J.value,pageSize:N.value,...G.value});0===e.code&&(L.value=e.data.list,M.value=e.data.total,J.value=e.data.page,N.value=e.data.pageSize,H.value=!0)};return I({open:R}),(e,x)=>{const I=g,K=E,W=v,X=j,Y=B,Z=y,$=f,ee=C;return a(),l(ee,{modelValue:H.value,"onUpdate:modelValue":x[3]||(x[3]=e=>H.value=e),title:"媒体库",size:"650px"},{default:t((()=>[s(h,{title:"点击“文件名/备注”可以编辑文件名或者备注内容。"}),o("div",k,[s(D,{imageCommon:F.value,"onUpdate:imageCommon":x[0]||(x[0]=e=>F.value=e),class:"upload-btn-media-library",onOnSuccess:R},null,8,["imageCommon"]),s(b,{imageUrl:T.value,"onUpdate:imageUrl":x[1]||(x[1]=e=>T.value=e),"file-size":512,"max-w-h":1080,class:"upload-btn-media-library",onOnSuccess:R},null,8,["imageUrl"]),s(X,{ref:"searchForm",inline:!0,model:G.value},{default:t((()=>[s(K,{label:""},{default:t((()=>[s(I,{modelValue:G.value.keyword,"onUpdate:modelValue":x[2]||(x[2]=e=>G.value.keyword=e),class:"keyword",placeholder:"请输入文件名或备注"},null,8,["modelValue"])])),_:1}),s(K,null,{default:t((()=>[s(W,{type:"primary",icon:"search",onClick:R},{default:t((()=>[r("查询")])),_:1})])),_:1})])),_:1},8,["model"])]),o("div",w,[(a(!0),i(n,null,u(L.value,((e,r)=>(a(),i("div",{key:r,class:"media-box"},[o("div",U,[(a(),l(Z,{key:r,src:m(A)(e.url),onClick:a=>{return l=e.url,t=O.target,s=O.targetKey,t&&s&&(t[s]=l),q("enterImg",l),void(H.value=!1);var l,t,s}},{error:t((()=>[o("div",z,[s(Y,null,{default:t((()=>[S])),_:1})])])),_:2},1032,["src","onClick"]))]),o("div",{class:"img-title",onClick:a=>(async e=>{c.prompt("请输入文件名或者备注","编辑",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"不能为空",inputValue:e.name}).then((async({value:a})=>{e.name=a,0===(await _(e)).code&&(d({type:"success",message:"编辑成功!"}),R())})).catch((()=>{d({type:"info",message:"取消修改"})}))})(e)},p(e.name),9,V)])))),128))]),s($,{"current-page":J.value,"page-size":N.value,total:M.value,style:{"justify-content":"center"},layout:"total, prev, pager, next, jumper",onCurrentChange:Q,onSizeChange:P},null,8,["current-page","page-size","total"])])),_:1},8,["modelValue"])}}};export{O as _};
